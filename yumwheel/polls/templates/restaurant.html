{%extends "index.html"%}
{%load static %}

{%block title%}The Yum Wheel suggests you eat at...{%endblock%}
{% block content %}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <a class="navbar-brand" href="#">The Yum Wheel suggests you eat at {{variable}}</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse"
  data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
  aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
      </li>
    </ul>
    <form class="form-inline my-2 my-lg-0">
      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
  </div>
</nav>

<style>
#map{
  height:500px;
  width: 60%;
  margin: 0 auto;
}
</style>
<!-- size of map -->

<div id = "map"></div>

<script>
  function initMap(){
    var options = {
      zoom:14,
      center:{lat:39.7285,lng:-121.8375}
    }
    var map = new google.maps.Map(document.getElementById('map'), options);
    if(navigator.geolocation){
      navigator.geolocation.getCurrentPosition(function(position){
        var pos = {
          lat:position.coords.latitude,
          lng:position.coords.longitude
        };
        infoWindow.setPosition(pos);
        infoWindow.setContent('Location found.');
        infoWindow.open(map);
      }, function(){
        handleLocationError(true, infoWindow, map.getCenter());
      });
    }
    else{
      handleLocationError(flase, infoWindow, map.getCenter())
    }
    var request = {
      location: pos,
      radius: '500',
      type:['restaurant']
    };
    var service = new google.maps.places.PlaceService(map);
    service.nearbySearch(request, callback);
  }

  function callback(results, status) {
    if(status == google.maps.places.PlacesServiceStatus.OK){
      for(var i = 0; i < results.length; i++){
        var place = results[i];
        createMarker(results[i]);
      }
    }
  }

  function handleLocationError(browserHasGeolocation, infoWindow, pos){
    infoWindow.setPosition(pos);
    infoWindow.setContent(browserHasGeolocation ?
                        'Error: The service failed.':
                        'Error: Your browser does not support geolocation.');
    infoWindow.open(map);
  }

</script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyACc6IrDW1i_Pee4QSl59bySwB0Bq75KdM&libraries=places&callback=initMap"></script>
<div style = "text-align:center">
  <a href="/" class="button">Return to Yum Wheel</a>
</div>
{% endblock %}
